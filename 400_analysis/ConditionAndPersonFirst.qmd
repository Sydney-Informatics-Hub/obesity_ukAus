---
title: "Condition and person-first language & use of 'the obese'"
execute: 
  message: false
  warning: false
---

## Executive summary

- Both corpora had data from 2008-2016, which was used for the analyses below.

We use the following tests to compare the sub-corpora:

- Chi-square tests, considering the total sub-corpus word count as the probability of observing a specific feature.
- Parametric t-tests comparing the mean frequencies, with texts without the feature considered to have a value of 0.
- The non-parametric Fisher-Pitman Permutation Test test with 10000 re-samples, comparing the mean frequencies, with texts without the feature considered to have a value of 0. 

### Article length differences:

- Articles in Australian broadsheets are longer than in Australian tabloids (mean 841.70 vs 555.04, respectively, p(FP) < 1e-05).
- Articles in UK broadsheets are longer than in UK tabloids (mean 718.31 vs 561.20, respectively, p(FP) < 1e-05).
- Articles in Australian broadsheets are longer than in UK broadsheets (mean 841.70 vs 718.31, respectively, p(FP) < 1e-05).
- There is no difference in length between articles in Australian and UK tabloids (mean 555.04 vs 561.20, respectively).

### Use of person-first language:

- Australian broadsheets have somewhat higher total number of instances (p(Chi-sq) < 0.05) and number of articles (p < 0.001) using person-first language than Australian tabloids, however, this difference is not supported when considering the mean frequency of language use across the corpus with parametric or non-parametric tests.

- In the UK corpus, no differences in the number of instances or articles are observed between tabloids and broadsheets, when considering contingency table and frequency based analyses similar to the above.

- Australian broadsheets have somewhat higher total number of instances (p(Chi-sq) < 0.005) and number of articles (p < 0.005) using person-first language than UK broadsheets. This difference is supported when considering the mean frequency of language use (mean Australian broadsheets = 17.81 words per million (wpm), mean UK broadsheets 8.52 wpm) across the corpus with parametric and non-parametric tests (p <0.05)).

- There is no difference between the number of instances, articles or frequency of between Australian and UK tabloids.

### Use of condition-first language:

- Australian broadsheets have somewhat lower total number of instances (p(Chi-sq) < 0.001) and number of articles (p < 0.1) using condition-first language than Australian tabloids. If we instead look at the frequency of use, the opposite result is observed, with a higher frequency of condition-first language in tabloids than in broadsheets (mean broadsheets = 847.96 wpm vs 1315.95 wpm in tabloids, p(FP) < 1e-04). This discrepancy may be attributable to the fact that articles in broadsheets are substantially longer than those in tabloids, so comparing mean frequencies of the same number of instances results in a difference frequency because the word count being divided by for broadsheets is larger than that of tabloids.

- In the UK corpus, there is a higher number of instances and articles containing at least one instance of condition-first language used in tabloids, and a lower number of instances in broadsheets (p < 0.001). A very small difference is also detected, with a higher mean frequency in tabloids than broadsheets (mean broadsheets 629.40 wpm, mean of tabloids 835.37 wpm, p(FP) < 1e-04)

- There is a higher number of instances and articles with at least one instance (p(Chi-sq) < 0.001) of condition-first language in Australian vs UK broadsheets. If we consider the frequency, a very small difference is also detected, with Australian broadsheets having a higher frequency than UK ones (mean Australian 847.96 wpm, mean UK 629.40 wpm, p(FP) < 1e-04).

- There is a higher number of instances and articles that use condition-first language in Australian tabloids, and a lower number in UK tabloids (p(Chi-sq) < 0.001). The frequency is also higher in Australian tabloids (mean Australian 1315.95 wpm, mean UK 835.37 wpm, p(FP) < 1e-04). This is especially striking given that there is no difference in overall article length between Australian and UK tabloids.


### Use of adjectival nominal "the obese"

- In the Australian corpus, no differences in the number of instances or articles are observed between tabloids and broadsheets when considering contingency table based analysis. There is a very small difference detected (p(t-test) < 0.05, p(FP) < 0.1) when considering frequencies, with tabloids having a higher frequency of use of condition-first language vs broadsheets (mean broadsheet frequency 42.65 wpm, mean tabloid 70.46 wpm). This discrepancy is most likely at least partially explained by the much longer article lengths of broadsheets vs tabloids in this corpus.

- Similarly, in the UK corpus, no differences in the number of instances or articles are observed between tabloids and broadsheets when considering contingency table based analysis. There is a very small difference detected (p(t-test) < 0.01, p(FP) < 0.01) when considering frequencies, with tabloids having a higher frequency of use of "the obese"  vs broadsheets (mean broadsheet frequency 62.96 wpm, mean tabloid 96.08 wpm). This discrepancy is most likely at least partially explained by the much longer article lengths of broadsheets vs tabloids in this corpus, similar to the Australian corpus.

- When comparing use of "the obese" in the Australian vs UK broadsheets, no differences in the number of instances or articles are observed between tabloids and broadsheets when considering contingency table based analysis. There is a very small difference detected (p(t-test) < 0.01, p(FP) < 0.01) when considering frequencies, with UK broadsheets having a higher frequency of use of "the obese" vs Australian ones (mean frequency Australia - 42.65 wpm, UK - 62.96 wpm).


- There is a somewhat lower number of total instances of use and articles with at least one instance of use of "the obese" in Australian tabloids, and a higher number in UK tabloids  (p(Chi-sq) < 0.05). However, this difference is not supported by frequency analysis, when using both parametric or non-parametric tests.


```{r loadLibs, warning=FALSE, message=FALSE}
library(here)
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(knitr)
library(patchwork)
library(corrplot)
library(coin)
library(ggvenn)
theme_set(theme_minimal())
```


```{r loadData, message=FALSE}
metadata <-read_csv(here::here("200_data_clean/", "full_metadata.csv"))
both_datasets <-  read_csv(here::here("200_data_clean/", "both_datasets.csv")) |> 
  # get data for correct time window
  filter(year >= 2008 & year <=2016)

source(here::here("400_analysis", "functions.R"))

# get some wordcounts 
au_tabloid_wordcounts <- get_wc(
  corpuslabel = "AUS",
  sourcetypelabel = "tabloid")

au_broadsheet_wordcounts <- get_wc(
  corpuslabel = "AUS",
  sourcetypelabel = "broadsheet")

uk_tabloid_wordcounts <- get_wc(
  corpuslabel = "UK",
  sourcetypelabel = "tabloid")

uk_broadsheet_wordcounts <- get_wc(
  corpuslabel = "UK",
  sourcetypelabel = "broadsheet")


frequency_table <-
  metadata |>
  select(article_id, corpus, source_type) |> 
  left_join(
    {
  # this gets a frequency table per article where
  # a language type is used
  both_datasets |>
  select(dataset, article_id, freq_per_million_words) |>
  pivot_wider(names_from = dataset, 
              names_glue = "{dataset}_freq",
              values_from = freq_per_million_words,
              values_fill = 0)}
  ) |>
  replace_na(list(cond_freq = 0, 
                  pers_freq = 0,
                  obes_freq = 0))
```

## Proportion and number of articles using any of the language types in the two corpora

Let's find the total number of articles that use one or more language types in the two corpora.

```{r}
article_id_cond <- get_article_ids(both_datasets, "cond")
article_id_pers <- get_article_ids(both_datasets, "pers")
article_id_obes <- get_article_ids(both_datasets, "obes")

ggvenn(list(
  `Condition first` = article_id_cond,
  `Person first` = article_id_pers,
  `Obese` = article_id_obes),
  fill_color = c("white", "white", "white")) +
  labs(title = "Number of articles that use the language features")

for_stacked_chart <-
  metadata |>
  select(article_id, corpus, source_type) |>
  mutate(grp = case_when(
    article_id %in% base::intersect(base::intersect(article_id_cond, article_id_pers), article_id_obes) ~ "all3",
    # two
    article_id %in% base::intersect(article_id_cond, article_id_pers) ~ "cond_pers",
    article_id %in% base::intersect(article_id_obes, article_id_cond) ~ "cond_obes",
    article_id %in% base::intersect(article_id_obes, article_id_pers) ~ "pers_obes",
    # one
    article_id %in% article_id_cond ~ "cond",
    article_id %in% article_id_pers ~ "pers",
    article_id %in% article_id_obes ~ "obes",
    # none
    TRUE ~ "none"
  )) 

ggsave(device = "png",
       here::here("400_analysis","stacked_chart.png"),
       bg = "white",
       width = 10,
       height = 4)

for_stacked_chart |> 
  mutate(group = case_when(
    grp == "cond_obes" ~ "two",
    grp == "pers_obes" ~ "two",
    grp == "cond_pers" ~ "two",
    TRUE ~ grp
  ))  |>
  mutate(group = factor(group, 
 levels = c("none", "all3", "two", "cond_obes", "cond_pers", "pers_obes", "obes", "pers", "cond"),
 labels = c(
   "no occurrences of any of the three targeted language practices",
   "occurrences of all three targeted language practices",
   "occurrences of two of the three targeted language practices",
   "cond_obes", "cond_pers", "pers_obes",
   "occurrences of adjectival nominal 'the obese'",
   "occurrences of person-first language",
   "occurrences of condition-first language"
   ))) |>
  ggplot() + 
    geom_bar(
      aes(fill=group, 
          x=source_type),
      position="fill") + 
  facet_grid(~corpus) + theme_bw() + 
  scale_fill_brewer(palette = "Accent") +
 scale_y_continuous(name = "Proportion articles in corpus",
                    labels = scales::percent) +
 # set axis limits in coord_cartesian
 # + coord_cartesian(ylim = c(0, 0.4))
# scale_fill_grey(start = 0.9, end = 0.2) + 
  theme(axis.text.x = element_text(angle = 35, vjust = 1, hjust=1))+
  labs(x = "",
       fill = "") 

```

```{r}
corpus_articles_grouped <- for_stacked_chart |>
  group_by(corpus, source_type) |>
  count() |> 
  rename(total_articles = n)

for_stacked_chart |> 
  group_by(corpus, source_type) |>
  count(grp) |>
  arrange(-n) |>
  left_join(corpus_articles_grouped) |>
  mutate(percent = round(100 * n/total_articles, 2)) |>
  select(-total_articles) |>
  pivot_wider(names_from = corpus, values_from = c(n, percent), values_fill = 0) |>
  rename(observed_language = grp) |>
  kable()
```




## Article length differences in Australian and UK broadsheets and tabloids

### Australian broadsheets vs tabloids

Are texts in the Australian sub-corpus used for this study also longer than in broadsheets than in tabloids, like was reported for the larger study?

```{r}
histogram_pairwise(au_broadsheet_wordcounts,
                   au_tabloid_wordcounts,
                   "broadsheet",
                   "tabloid")
```

Let's use a t-test to consider?

```{r results='asis'}
report::report(t.test(au_broadsheet_wordcounts,
                      au_tabloid_wordcounts))
```

Does the non-parametric FP test support this as well?

```{r}
fp_test_wc(wc1 = au_broadsheet_wordcounts,
           wc2 = au_tabloid_wordcounts,
           label1 = "broadsheet",
           label2 = "tabloid")
```

Yes, it does.

### UK broadsheets vs tabloids

Are texts in tabloids also shorter than in broadsheets in the UK, like they are in Australia?

```{r}
histogram_pairwise(wc1 = uk_broadsheet_wordcounts,
                   wc2 = uk_tabloid_wordcounts,
                   label1 = "broadsheets",
                   label2 = "tabloids")
```


```{r results='asis'}
report::report(t.test(
  uk_broadsheet_wordcounts, 
  uk_tabloid_wordcounts))
```

Yes, they are, although the effect size is not as large (small vs medium for the Australian corpus). Hence this is what probably explains the contradiction.

Does the non-parametric FP test support this as well?

```{r}
fp_test_wc(wc1 = uk_broadsheet_wordcounts,
           wc2 = uk_tabloid_wordcounts,
           label1 = "broadsheet",
           label2 = "tabloid")
```

Yes, it does.

### Australian vs UK broadsheets


Are texts in broadsheets from Australia and the UK different in length?

```{r}
histogram_pairwise(au_broadsheet_wordcounts,
                   uk_broadsheet_wordcounts,
                   "Aus",
                   "UK")
```

Let's use a t-test to consider?

```{r results='asis'}
report::report(t.test(au_broadsheet_wordcounts,
                      uk_broadsheet_wordcounts))
```

Yes, there appears to be a small difference in text length between Australian and UK broadsheets, with articles in UK broadsheets being somewhat shorter.

Does the non-parametric FP test support this as well?

```{r}
fp_test_wc(wc1 = au_broadsheet_wordcounts,
           wc2 = uk_broadsheet_wordcounts,
           label1 = "AUS",
           label2 = "UK")
```

Yes, it does.

### Australian vs UK tabloids


Are texts in tabloids from Australia and the UK different in length?

```{r}
histogram_pairwise(au_tabloid_wordcounts,
                   uk_tabloid_wordcounts,
                   "Aus",
                   "UK")
```

Let's use a t-test to consider?

```{r results='asis'}
report::report(t.test(au_tabloid_wordcounts,
                      uk_tabloid_wordcounts))
```

No, there appears to be no difference in length between articles in Australian and UK tabloids.

Does the non-parametric FP test support this as well?

```{r}
fp_test_wc(wc1 = au_tabloid_wordcounts,
           wc2 = uk_tabloid_wordcounts,
           label1 = "AUS",
           label2 = "UK")
```

Yes, it also supports the observation of no difference between Australian and UK tabloid article lengths.

## Person-first language

### Australian corpus

Let's generate a frequency table (sum of no hits in text) for person-first language:

```{r getmatrixpers}
pers_4chisq_matrix_sumhits <-
  both_datasets |> 
  filter(dataset == "pers") |>
  generate_conting_tab_sumhits() |>
  as.matrix()

pers_4chisq_matrix_noarticles <-
  both_datasets |> 
  filter(dataset == "pers") |>
  generate_conting_tab_noarticles() |>
  as.matrix()

pers_4chisq_matrix_sumhits |>
  kable()
```

We also need to find the probability of observing these values given the total word count in each of the cells (for example,  the number of total words in the Australian broadsheet corpus). Let's calculate these values:

```{r}
generate_wc(metadata) |>
  kable()
```

Is there a difference in the frequency of use of person-first language in tabloids and broadsheets in the Australian corpus?

```{r}
get_chisq_tabloid_broadsheet(pers_4chisq_matrix_sumhits, 
                             col_no = 1, 
                             type = "wc") |>
  kable()
```

Based on a Chi-square test, there is a slight difference between the expected and observed frequency of instances of person-first language in the Australian corpus (p < 0.05), with broadsheets having somewhat more instances of person-first language than tabloids in the Australian corpus.

This also holds true when we consider the number of articles that have at least one instance of person-first language:

```{r}
get_chisq_tabloid_broadsheet(pers_4chisq_matrix_noarticles, 
                             col_no = 1, 
                             type = "art") |>
  kable()
```


If we consider a t-test on the frequency (per million words) of the Australian corpus (including all texts in each sub-corpus, including those without instances), a difference is not detected.

```{r results='asis'}
ttest_broad_vs_tabl(frequency_table, "AUS", "pers_freq")
```

If we instead use a non-parametric test, there is also no difference detected.

```{r}
fp_test_broad_vs_tabl(freq_table = frequency_table,
                      corpus_label = "AUS",
                      dataset = "pers",
                      myformula = formula(pers_freq ~ source_type),
                      dist = mydistribution)
```



### UK corpus

What about the total number of instances of person-first language in the UK corpus?

```{r}
get_chisq_tabloid_broadsheet(pers_4chisq_matrix_sumhits, 
                             col_no = 2,
                             type = "wc") |>
  kable()
```

No difference is observed between the number of observed and expected instances of use of person-first language in the UK corpus between tabloids and broadsheets.

```{r}
get_chisq_tabloid_broadsheet(pers_4chisq_matrix_noarticles, 
                             col_no = 2, 
                             type = "art") |>
  kable()
```

This lack of a difference also holds true when we consider the number of articles that have at least one instance of person-first language.

If we consider a t-test on the frequency (per million words) of the UK corpus (including all texts in each sub-corpus, including those without instances), a difference is not detected.

```{r results='asis'}
ttest_broad_vs_tabl(frequency_table, "UK", "pers_freq")
```

If we use a non-parametric test, there is also no difference detected.

```{r}
fp_test_broad_vs_tabl(freq_table = frequency_table,
                      corpus_label = "UK",
                      dataset = "pers",
                      myformula = formula(pers_freq ~ source_type),
                      dist = mydistribution)
```


### Australian vs UK broadsheets
Let's compare Australian and UK broadsheets.

Is there a difference in the frequency of use of person-first language in broadsheets in the Australian vs UK corpus?

```{r}
# broadsheets
get_chisq_aus_uk(pers_4chisq_matrix_sumhits, 
                 row_no = 1,
                 type = "wc")|>
  kable()

```
There is a difference between the expected and observed frequency of instances of person-first language in Australian vs UK broadsheets(p < 0.005).

We can see that person-first language is used more frequently than we would expect in Australian broadsheets, and less frequently in UK ones.

```{r}
# broadsheets
get_chisq_aus_uk(pers_4chisq_matrix_noarticles, 
                 row_no = 1,
                 type = "art")|>
  kable()
```

This also holds true when we consider the number of articles that have at least one instance of person-first language.

If we consider the frequency (per million words) of the Australian vs UK broadsheets (including all texts in each sub-corpus, including those without instances), a very small difference is detected, with Australian broadsheets having a higher frequency than UK ones:

```{r results='asis'}
ttest_aus_vs_uk(frequency_table, "broadsheet", "pers_freq")
```

Is this supported by non-parametric analysis

```{r}
fp_test_aus_vs_uk(freq_table = frequency_table,
                  source_label = "broadsheet",
                  dataset = "pers",
                  myformula = formula(pers_freq ~ corpus),
                  dist = mydistribution)
```



### Australian vs UK tabloids
Let's compare Australian and UK tabloids

Is there a difference in the frequency of use of person-first language in tabloids in the Australian vs UK corpus?

```{r}
# tabloids
get_chisq_aus_uk(pers_4chisq_matrix_sumhits, 
                 row_no = 2,
                 type = "wc")|>
  kable()
```

The observed and expected number of instances of person-first language is approximately the same in Australian and British tabloids.

This also holds true when we consider the number of articles that have at least one instance of person-first language:
```{r}
# tabloids
get_chisq_aus_uk(pers_4chisq_matrix_noarticles, 
                 row_no = 2,
                 type = "art")|>
  kable()
```

If we consider the frequency (per million words) in the Australian vs UK tabloids (including all texts in each sub-corpus, including those without instances), no significant differences are observed as well.

```{r results='asis'}
ttest_aus_vs_uk(frequency_table, "tabloid", "pers_freq")
```

The non-parametric test leads to a similar conclusion:
```{r}
fp_test_aus_vs_uk(frequency_table,
                  "tabloid",
                  "pers",
                  formula(pers_freq ~ corpus),
                  dist = mydistribution)
```


***

## Condition-first language

Let's generate a frequency table (sum of no hits in text) for condition-first language:

```{r}
cond_4chisq_matrix_sumhits <-
  both_datasets |> 
  filter(dataset == "cond") |>
  generate_conting_tab_sumhits() |>
  as.matrix()

cond_4chisq_matrix_noarticles <-
  both_datasets |> 
  filter(dataset == "cond") |>
  generate_conting_tab_noarticles() |>
  as.matrix()

cond_4chisq_matrix_sumhits |>
  kable()
```

### Australian corpus

We can assess the difference between these total number of uses of condition-first language in the Australian corpus, using a Chi-square test:

```{r}
get_chisq_tabloid_broadsheet(cond_4chisq_matrix_sumhits, 
                             col_no = 1,
                             type = "wc") |>
  kable()
```

There is a higher number of instances of condition-first language used in tabloids, and a lower number of instances in broadsheets in the Australian corpus.

```{r}
get_chisq_tabloid_broadsheet(cond_4chisq_matrix_noarticles, 
                             col_no = 1,
                             type = "art")|>
  kable()
```

This also somewhat holds true, although is not highly significant, when we consider the number of articles that have at least one instance of condition-first language.

If we consider a t-test on the frequency (per million words) of the Australian corpus (including all texts in each sub-corpus, including those without instances), a very small difference is detected, with tabloids having a higher frequency of use of condition-first language vs broadsheets.

```{r results='asis'}
ttest_broad_vs_tabl(frequency_table, "AUS", "cond_freq")
```


```{r}
fp_test_broad_vs_tabl(frequency_table,
                      corpus_label = "AUS",
                      dataset = "cond", 
                      formula(cond_freq ~ source_type), 
                      dist = mydistribution)
```



### UK corpus

We can assess the difference between these total number of uses of condition-first language in the UK corpus, using a Chi-square test. There is a higher number of instances of condition-first language used in tabloids, and a lower number of instances in broadsheets, in the UK corpus:

```{r _uk}
get_chisq_tabloid_broadsheet(cond_4chisq_matrix_sumhits, 
                             col_no = 2,
                             type = "wc") |>
  kable()
```

This also holds true when we consider the number of articles that have at least one instance of condition-first language.

```{r}
get_chisq_tabloid_broadsheet(cond_4chisq_matrix_noarticles, 
                             col_no = 2,
                             type = "art") |>
  kable()
```

If we consider a t-test on the frequency (per million words) of the UK corpus (including all texts in each sub-corpus, including those without instances), a very small difference is detected, with a higher mean frequency in tabloids than broadsheets.

```{r results='asis'}
ttest_broad_vs_tabl(frequency_table, "UK", "cond_freq")
```

This is also supported by the FP test:

```{r}
fp_test_broad_vs_tabl(frequency_table,
                      corpus_label = "UK",
                      dataset = "cond")
```


### Australian vs UK broadsheets
There is a higher number of uses of condition-first language in Australian broadsheets, and a lower number in UK broadsheets:


```{r}
get_chisq_aus_uk(cond_4chisq_matrix_sumhits, 
                 row_no = 1,
                 type = "wc") |>
  kable()
```

This also holds true when we consider the number of articles that have at least one instance of condition-first language:

```{r}
get_chisq_aus_uk(cond_4chisq_matrix_noarticles, 
                             row_no = 1,
                             type = "art") |>
  kable()
```

If we consider the frequency (per million words) of the Australian vs UK broadsheets (including all texts in each sub-corpus, including those without instances), a very small difference is detected, with Australian broadsheets having a higher frequency than UK ones:

```{r results='asis'}
ttest_aus_vs_uk(frequency_table, "broadsheet", "cond_freq")
```

This is also supported by the FP test:

```{r}
fp_test_aus_vs_uk(freq_table = frequency_table, 
    source_label = "broadsheet",
    dataset = "cond",
    myformula = formula(cond_freq ~ corpus),
    dist = mydistribution)
```



### Australian vs UK tabloids

There is a higher number of uses of condition-first language in Australian tabloids, and a lower number in UK tabloids:

```{r}
get_chisq_aus_uk(cond_4chisq_matrix_sumhits, 
                 row_no = 2,
                 type = "wc") |>
  kable()
```


This also holds true when we consider the number of articles that have at least one instance of condition-first language:

```{r}
get_chisq_aus_uk(cond_4chisq_matrix_noarticles, 
                             row_no  = 2,
                             type = "art") |>
  kable()
```

If we consider the frequency (per million words) in the Australian vs UK tabloids (including all texts in each sub-corpus, including those without instances), the frequency of use of condition-first language is higher in Australian tabloids, and lower in UK ones.

```{r results='asis'}
ttest_aus_vs_uk(frequency_table, "tabloid", "cond_freq")
```

This is also supported by the FP test:

```{r}
fp_test_aus_vs_uk(freq_table = frequency_table, 
    source_label = "tabloid",
    dataset = "cond",
    myformula = formula(cond_freq ~ corpus),
    dist = mydistribution)
```


As shown above, there is no significant difference in articles lengths between Australian and UK tabloids.

***

## Use of adjectival nominal "the obese"

Let's generate a frequency table (sum of no hits in text) for use of "the obese":

```{r}
obes_4chisq_matrix_sumhits <-
  both_datasets |> 
  filter(dataset == "obes") |>
  generate_conting_tab_sumhits() |>
  as.matrix()

obes_4chisq_matrix_noarticles <-
  both_datasets |> 
  filter(dataset == "obes") |>
  generate_conting_tab_noarticles() |>
  as.matrix()

obes_4chisq_matrix_sumhits |>
  kable()
```

### Australian corpus

We can assess the difference between these total number of uses of "the obese" language in the Australian corpus, using a Chi-square test:

```{r}
get_chisq_tabloid_broadsheet(obes_4chisq_matrix_sumhits, 
                             col_no = 1,
                             type = "wc") |>
  kable()
```

There is no difference in the total count of use of "the obese" in Australian broadsheets vs tabloids.

```{r}
get_chisq_tabloid_broadsheet(obes_4chisq_matrix_noarticles, 
                             col_no = 1,
                             type = "art")|>
  kable()
```

There is no difference in the number of articles that use "the obese" in Australian broadsheets vs tabloids.

If we consider a t-test on the frequency (per million words) of the Australian corpus (including all texts in each sub-corpus, including those without instances), a very small difference is  detected (p < 0.05), with tabloids having a higher frequency of use of condition-first language vs broadsheets.

```{r results='asis'}
ttest_broad_vs_tabl(frequency_table, "AUS", "obes_freq")
```

This could be attributed in part to the longer article length described for tabloids than for broadsheets above.

This is not strongly supported (p < 0.1) via a non-parametric FP test:

```{r}
fp_test_broad_vs_tabl(frequency_table,
                      corpus_label = "AUS",
                      dataset = "obes", 
                      formula(obes_freq ~ source_type), 
                      dist = mydistribution)
```


### UK corpus

We can assess the difference between these total number of uses of "the obese" in the UK corpus between tabloids and broadsheets. Similar to the Australian corpus, no difference is detected.

```{r}
get_chisq_tabloid_broadsheet(pers_4chisq_matrix_sumhits, 
                             col_no = 2,
                             type = "wc") |>
  kable()
```

There is also no difference when we consider the number of articles that have at least one instance of condition-first language.

```{r}
get_chisq_tabloid_broadsheet(pers_4chisq_matrix_noarticles, 
                             col_no = 2,
                             type = "art") |>
  kable()
```

If we consider a t-test on the frequency (per million words) of the UK corpus (including all texts in each sub-corpus, including those without instances), a very small difference is detected, with a higher mean frequency in tabloids than broadsheets.

```{r results='asis'}
ttest_broad_vs_tabl(frequency_table, "UK", "obes_freq")
```

Again, like the case of the Australian corpus, this could be explained by articles in tabloids being overall shorter than in broadsheets in the UK corpus.

There is some support for this difference when using a non-parametric FP test (p < 0.01):

```{r}
fp_test_broad_vs_tabl(frequency_table,
                      corpus_label = "UK",
                      dataset = "obes", 
                      formula(obes_freq ~ source_type), 
                      dist = mydistribution)
```

### Australian vs UK broadsheets

There is not a strong difference in use of "the obese" between Australian and UK broadsheets.

```{r}
get_chisq_aus_uk(obes_4chisq_matrix_sumhits, 
                 row_no = 1,
                 type = "wc") |>
  kable()
```

This lack of a difference also holds true when we consider the number of articles that have at least one instance of "the obese":

```{r}
get_chisq_aus_uk(obes_4chisq_matrix_sumhits, 
                             row_no = 1,
                             type = "art") |>
  kable()
```


If we consider the frequency (per million words) of the Australian vs UK broadsheets (including all texts in each sub-corpus, including those without instances), a very small difference is detected, with UK broadsheets having a higher frequency than Australian ones:

```{r results='asis'}
ttest_aus_vs_uk(frequency_table, "broadsheet", "obes_freq")
```

This is also supported by the FP test:

```{r}
fp_test_aus_vs_uk(freq_table = frequency_table, 
    source_label = "broadsheet",
    dataset = "obes",
    myformula = formula(obes_freq ~ corpus),
    dist = mydistribution)
```

This discrepancy may be explained by the fact that, as discussed above, articles in UK broadsheets are somewhat shorter than in Australian ones.


### Australian vs UK tabloids

There is a somewhat lower number of total instances of use of "the obese" in Australian tabloids, and a higher number in UK tabloids  (p < 0.05):

```{r}
get_chisq_aus_uk(obes_4chisq_matrix_sumhits, 
                 row_no = 2,
                 type = "wc") |>
  kable()
```

This also holds true when we consider the number of articles that have at least one instance of "the obese":

```{r}
get_chisq_aus_uk(obes_4chisq_matrix_noarticles, 
                             row_no  = 2,
                             type = "art") |>
  kable()
```

If we consider the frequency (per million words) in the Australian vs UK tabloids (including all texts in each sub-corpus, including those without instances), no significant differences in frequency are observed.

```{r results='asis'}
ttest_aus_vs_uk(frequency_table, "tabloid", "obes_freq")
```

This is also supported by the FP test:

```{r}
fp_test_aus_vs_uk(freq_table = frequency_table, 
    source_label = "tabloid",
    dataset = "obes",
    myformula = formula(obes_freq ~ corpus),
    dist = mydistribution)
```

As shown above, there is no significant difference in articles lengths between Australian and UK tabloids.
